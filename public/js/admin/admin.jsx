import{j as e,a as C,r as h}from"./assets/react-C5qdKvk_.js";import{a as _}from"./assets/axios-_lsJg-3Y.js";import{r as E}from"./assets/react-table-C8DmCTwF.js";import{F as B,a as P,b as R}from"./assets/react-icons-iMiqqjRZ.js";import{l as T}from"./assets/lodash-grLx7Bpj.js";import{D as L}from"./assets/react-datepicker-DV9tePJh.js";import{c as k}from"./assets/react-dom-CB1LTWp1.js";import"./assets/clsx-B-dksMZM.js";import"./assets/react-onclickoutside-CREQk6_T.js";import"./assets/date-fns-Crri_o3n.js";import"./assets/@floating-ui-B4nMepu_.js";import"./assets/scheduler-CzFDRTuY.js";document.addEventListener("DOMContentLoaded",function(i){const r=document.querySelector("#ref_popup");r&&(document.querySelector(".open_ref_pop").addEventListener("click",function(t){t.preventDefault(),r.classList.add("open")}),document.querySelector(".close_popup").addEventListener("click",function(t){t.preventDefault(),r.classList.remove("open")}));const d=document.querySelectorAll(".ban_user");d&&d.forEach(t=>{t.addEventListener("click",D)});const u=document.querySelectorAll(".un_ban_user");u&&u.forEach(t=>{j(t)});function p(t,o){const n={banType:o},m=t.dataset.id;return _.post("/admin/ban-user/"+m,n).then(v=>{v.data.success&&(t.classList.remove("ban_user"),t.classList.remove("btn-danger"),t.classList.add("un_ban_user"),t.classList.add("btn-dark"),t.textContent="UnBan User",d.forEach(s=>{s.classList.contains("user_"+m)&&s.removeEventListener("click",D)}),j(t))}).catch(v=>{v.response?console.error("error.response: ",v.response):console.error("ERROR:: ",v)})}function x(t){t.addEventListener("click",D)}function j(t){t.addEventListener("click",function(o){return o.preventDefault(),_.post("/admin/unban-user/"+t.dataset.id).then(n=>{n.data.success&&(t.classList.remove("un_ban_user"),t.classList.remove("btn-dark"),t.classList.add("ban_user"),t.classList.add("btn-danger"),t.textContent="Ban User",x(t))}).catch(n=>{n.response?console.error("error.response: ",n.response):console.error("ERROR:: ",n)})})}const f=document.querySelector("#ban_user_button");f&&f.addEventListener("click",function(t){const o=t.target.dataset.id,n=document.querySelector("#ban_type").value,m=document.querySelector("a.user_"+o);p(m,n)});function D(t){document.querySelector("#ban_user_modal #ban_user_button").dataset.id=t.currentTarget.dataset.id,$("#ban_user_modal").modal("show")}console.log("hellothere!")});const U=(i,r)=>_.post(i,r).then(d=>{const u=d.data.data;return{success:!0,affiliateData:u.affiliateData,totals:u.totals}}).catch(d=>(d.response?console.error(d.response):console.error("ERROR:: ",d),{success:!1})),H=({isLoading:i,animate:r,data:d,columns:u,totals:p})=>{const{getTableProps:x,getTableBodyProps:j,headerGroups:f,rows:D,prepareRow:t}=E.useTable({columns:u,data:d||null},E.useSortBy);return e.jsxs("table",{className:"table table-borderless",...x(),children:[e.jsx("thead",{children:f==null?void 0:f.map(o=>e.jsx("tr",{...o.getHeaderGroupProps(),children:o.headers.map(n=>e.jsx("th",{...n.getHeaderProps(n.getSortByToggleProps()),children:e.jsxs("h5",{children:[e.jsx("span",{children:n.render("Header")}),n.isSorted?n.isSortedDesc?e.jsx(B,{}):e.jsx(P,{}):e.jsx(R,{})]})}))}))}),e.jsx("tbody",{...j(),children:T.isEmpty(d)?e.jsx("tr",{children:e.jsx("td",{className:i?"hidden no_stats":"no_stats",colSpan:"5",children:e.jsx("h3",{children:"No Stats Available"})})}):e.jsxs(e.Fragment,{children:[D==null?void 0:D.map((o,n)=>(t(o),e.jsx(C.Fragment,{children:e.jsx("tr",{...o.getRowProps(),children:o.cells.map(m=>e.jsx("td",{...m.getCellProps(),children:m.column.Header==="Offer"||m.column.Header==="Current Icons"?e.jsx("img",{src:m.value,alt:""}):e.jsx("p",{className:`${r?"animate hide":"animate"}`,children:m.render("Cell")})}))},n)},n))),p&&e.jsxs("tr",{className:"totals",children:[e.jsx("td",{children:e.jsx("h3",{children:"Totals"})}),e.jsx("td",{children:e.jsx("h3",{className:`${r?"animate hide":"animate"}`,children:p.totalRaw})}),e.jsx("td",{children:e.jsx("h3",{className:`${r?"animate hide":"animate"}`,children:p.totalUnique})}),e.jsx("td",{children:e.jsx("h3",{className:`${r?"animate hide":"animate"}`,children:p.totalConversions})}),e.jsx("td",{children:e.jsxs("h3",{className:`${r?"animate hide":"animate"}`,children:["$",p.totalPayout]})})]})]})})]})},N=i=>{window.location.href=i},F=i=>{window.location.href=i},q=({getStatsCall:i=null,filterByValue:r=null,setFilterByValue:d=null})=>{const[u,p]=h.useState(null),[x,j]=h.useState(null),[f,D]=h.useState(window.location.pathname),[t,o]=h.useState(1);h.useEffect(()=>{const s=window.location.search,l=new URLSearchParams(s),c=l.get("startDate"),a=l.get("endDate"),g=l.get("dateValue"),y=l.get("clear");if(c&&a){const w=new Date(c*1e3),S=new Date(a*1e3);p(w),j(S),o("custom")}else g?o(g):y||window.location.pathname.includes("users")?o("custom"):o(1)},[]);const n=(s,l)=>{let c=null,a=null;if(l==="start"?(p(s),c=s,x&&(a=x)):(j(s),a=s,u&&(c=u)),a&&c&&c<=a){o("custom");const g=Math.round(new Date(c)/1e3),y=Math.round(new Date(a)/1e3),w=r?"&filterBy="+r:"",S=f+"?startDate="+g+"&endDate="+y+w;N(S)}},m=s=>{if(p(null),j(null),o(s.target.value),s.target.value!=="custom"){const l=r?"&filterBy="+r:"",c=f+"?dateValue="+s.target.value+l;N(c)}},v=s=>{s.preventDefault();const l=r?"&filterBy="+r:"",c=f+"?clear=all"+l;F(c)},b=s=>{const l=s.target.value;d(l);const c=window.location.search,a=new URLSearchParams(c);(a==null?void 0:a.get("filterBy"))&&(a.set("filterBy",l),window.location.search=a.toString()),i(l==="publisher"?"/admin/stats/get/publisher":"/admin/stats/get/offer")};return e.jsxs("div",{className:"my_row",children:[f.includes("affiliate-stats")&&e.jsx("div",{className:"column_wrap filter_by",children:e.jsx("div",{className:"column",children:e.jsxs("select",{onChange:s=>b(s),value:r,children:[e.jsx("option",{value:"publisher",children:"Stats By Publisher"}),e.jsx("option",{value:"offer",children:"Stats By Offer"})]})})}),e.jsxs("div",{className:"column_wrap",children:[e.jsx("div",{className:"column",children:e.jsxs("select",{onChange:s=>m(s),value:t,children:[e.jsx("option",{value:"1",children:"Today"}),e.jsx("option",{value:"2",children:"Yesterday"}),e.jsx("option",{value:"3",children:"Week To date"}),e.jsx("option",{value:"4",children:"Month To Date"}),e.jsx("option",{value:"5",children:"Year To Date"}),e.jsx("option",{value:"6",children:"Last Week"}),e.jsx("option",{value:"7",children:"Last Month"}),e.jsx("option",{value:"custom",children:"Custom"})]})}),e.jsx("div",{className:"column",children:e.jsx(L,{selected:u,onChange:s=>n(s,"start"),selectsStart:!0,startDate:u,endDate:x,maxDate:new Date,placeholderText:"Start Date"})}),e.jsx("div",{className:"column",children:e.jsx(L,{selected:x,onChange:s=>n(s,"end"),selectsEnd:!0,startDate:u,endDate:x,minDate:u,maxDate:new Date,placeholderText:"End Date"})}),e.jsx("div",{className:"column clear",children:e.jsx("a",{className:"button blue",onClick:s=>v(s),href:"#",children:"Clear Filters"})})]})]})},A=()=>{const[i,r]=h.useState([]),[d,u]=h.useState([]),[p,x]=h.useState({startDate:null,endDate:null}),[j,f]=h.useState(!0),[D,t]=h.useState(!0),[o,n]=h.useState("publisher");h.useEffect(()=>{const l=window.location.search,a=new URLSearchParams(l).get("filterBy");a?(n(a),b(a==="offer"?"/admin/stats/get/offer":"/admin/stats/get/publisher")):b("/admin/stats/get/publisher")},[]);const m=h.useMemo(()=>[{Header:"Affiliate",accessor:"name"},{Header:"Raw Clicks",accessor:"rawCount"},{Header:"Unique Clicks",accessor:"uniqueCount"},{Header:"Conversions",accessor:"conversionCount"},{Header:"Payout",accessor:"payout"}],[]),v=h.useMemo(()=>[{Header:"Offer Name",accessor:"name"},{Header:"Raw Clicks",accessor:"rawCount"},{Header:"Unique Clicks",accessor:"uniqueCount"},{Header:"Conversions",accessor:"conversionCount"},{Header:"Payout",accessor:"payout"}],[]),b=h.useCallback(l=>{t(!0);const c=s();U(l,c).then(a=>{a.success?setTimeout(()=>{r(a.affiliateData),u(a.totals),t(!1),f(!1)},500):(t(!1),f(!1))})},[p]),s=()=>{const l=window.location.search,c=new URLSearchParams(l),a=c.get("startDate"),g=c.get("endDate"),y=c.get("dateValue"),w=c.get("clear");let S={};return a&&g?(x(()=>({startDate:a,endDate:g})),S={startDate:a,endDate:g}):y?S={dateValue:y}:w?S={clear:!0}:S={currentDay:!0},S};return e.jsxs("div",{className:"my_row",children:[e.jsx("div",{id:"admin_filters",children:e.jsx(q,{getStatsCall:b,filterByValue:o,setFilterByValue:n})}),e.jsx("div",{className:"table-responsive",children:e.jsx(H,{columns:o==="publisher"?m:v,data:i,isLoading:j,animate:D,totals:d})})]})};if(document.getElementById("admin_affiliate_stats")){const i=document.getElementById("admin_affiliate_stats");k(i).render(e.jsx(C.StrictMode,{children:e.jsx(A,{})}))}if(document.getElementById("admin_filters")){const i=document.getElementById("admin_filters");k(i).render(e.jsx(C.StrictMode,{children:e.jsx(q,{})}))}
